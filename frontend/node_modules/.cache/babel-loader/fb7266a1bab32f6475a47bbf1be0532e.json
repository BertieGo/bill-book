{"ast":null,"code":"import _classCallCheck from\"/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/workspace/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{fixedFloat,floorFloat}from\"../../utils/math\";import{Tooltip}from\"antd\";var FULL_CIRCLE_RADIUS=360;var HALF_CIRCLE_RADIUS=FULL_CIRCLE_RADIUS/2;var Pie=/*#__PURE__*/function(_React$Component){_inherits(Pie,_React$Component);var _super=_createSuper(Pie);function Pie(props){var _this;_classCallCheck(this,Pie);_this=_super.call(this,props);_this.width=void 0;_this.height=void 0;_this.renderPath=function(){var data=_this.props.data;var paths=[];var radius=_this.width/2;var cx=_this.width/2;var cy=_this.height/2;var sx=_this.width;var sy=_this.height/2;var prevPercent=0;data.forEach(function(item){var currentPercent=item.percent/100+prevPercent;var currentRadius=currentPercent*FULL_CIRCLE_RADIUS;var ex=floorFloat(cx+radius*Math.cos(currentRadius*Math.PI/HALF_CIRCLE_RADIUS));var ey=floorFloat(cy+radius*Math.sin(currentRadius*Math.PI/HALF_CIRCLE_RADIUS));var largeArcFlag=item.percent/100*FULL_CIRCLE_RADIUS>HALF_CIRCLE_RADIUS?'1':'0';var displayPercent=\"\".concat(floorFloat(item.percent),\"%\");var displayAmount=fixedFloat(item.amount);paths.push(/*#__PURE__*/React.createElement(Tooltip,{title:/*#__PURE__*/React.createElement(\"div\",{className:\"nowrap\"},\"\\u7C7B\\u578B\\uFF1A\".concat(item.title,\" \\u91D1\\u989D: \").concat(displayAmount,\" \\u5360\\u6BD4\\uFF1A\").concat(displayPercent))},/*#__PURE__*/React.createElement(\"path\",{d:\"M\".concat(sx,\" \").concat(sy,\" A \").concat(radius,\" \").concat(radius,\", 0, \").concat(largeArcFlag,\", 1, \").concat(ex,\" \").concat(ey,\" L \").concat(cx,\" \").concat(cy,\" Z\"),fill:item.color})));sx=ex;sy=ey;prevPercent=currentPercent;});return paths;};_this.width=200;_this.height=200;return _this;}_createClass(Pie,[{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"svg\",{width:\"\".concat(this.width,\"px\"),height:\"\".concat(this.height,\"px\"),version:\"1.1\",xmlns:\"http://www.w3.org/2000/svg\"},this.renderPath()));}}]);return Pie;}(React.Component);export{Pie as default};","map":{"version":3,"sources":["/workspace/src/components/Pie/index.tsx"],"names":["React","fixedFloat","floorFloat","Tooltip","FULL_CIRCLE_RADIUS","HALF_CIRCLE_RADIUS","Pie","props","width","height","renderPath","data","paths","radius","cx","cy","sx","sy","prevPercent","forEach","item","currentPercent","percent","currentRadius","ex","Math","cos","PI","ey","sin","largeArcFlag","displayPercent","displayAmount","amount","push","title","color","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport {IChartProps, IPathItem} from \"../../declare\";\nimport {fixedFloat, floorFloat} from \"../../utils/math\";\nimport {Tooltip} from \"antd\";\n\nconst FULL_CIRCLE_RADIUS = 360;\n\nconst HALF_CIRCLE_RADIUS = FULL_CIRCLE_RADIUS / 2;\n\nexport default class Pie extends React.Component<IChartProps, {}>{\n\n    private width: number;\n\n    private height: number;\n\n    constructor(props: IChartProps) {\n        super(props);\n        this.width = 200;\n        this.height = 200;\n    }\n\n    renderPath = () => {\n        const { data } = this.props;\n        const paths: JSX.Element[] = [];\n\n        const radius = this.width / 2;\n\n        const cx = this.width / 2;\n        const cy = this.height / 2;\n\n        let sx = this.width;\n        let sy = this.height / 2;\n\n        let prevPercent = 0;\n\n        data.forEach((item: IPathItem) => {\n\n            const currentPercent = (item.percent / 100) + prevPercent;\n\n            const currentRadius = currentPercent * FULL_CIRCLE_RADIUS;\n\n            const ex = floorFloat(cx + radius * Math.cos( currentRadius * Math.PI / HALF_CIRCLE_RADIUS));\n            const ey = floorFloat(cy + radius * Math.sin( currentRadius * Math.PI / HALF_CIRCLE_RADIUS));\n\n            const largeArcFlag = (item.percent / 100) * FULL_CIRCLE_RADIUS > HALF_CIRCLE_RADIUS ? '1' : '0';\n\n            const displayPercent = `${floorFloat(item.percent)}%`;\n            const displayAmount = fixedFloat(item.amount);\n\n            paths.push(\n                <Tooltip title={(<div className=\"nowrap\">{`类型：${item.title} 金额: ${displayAmount} 占比：${displayPercent}`}</div>)}>\n                    <path d={`M${sx} ${sy} A ${radius} ${radius}, 0, ${largeArcFlag}, 1, ${ex} ${ey} L ${cx} ${cy} Z`} fill={item.color}/>\n                </Tooltip>\n            )\n\n            sx = ex;\n            sy = ey;\n            prevPercent = currentPercent;\n        })\n\n        return paths;\n    }\n\n\n    render() {\n        return (\n            <div>\n                <svg width={`${this.width}px`} height={`${this.height}px`} version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">\n                    { this.renderPath() }\n                </svg>\n            </div>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}